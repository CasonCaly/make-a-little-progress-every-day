# Mixed-cell cellular automata: A new approach for simulating the spatiotemporal dynamics of mixed land use structures

混合元胞CA模型：一种新的混合土地利用结构时空动态模拟方法

## 摘要
传统元胞自动机（CA）模型通常假设每个元胞在每个时刻都只包含一种土地利用类型，因此传统 CA 模型忽略了元胞内部的混合土地利用结构。我们的最新研究提出了一种基于混合元胞的CA模型（Mixed-cell Cellular Automata，MCCA），该模型的元胞内部含有各类用地的覆盖比例，即元胞内部包含土地利用结构，为混合土地利用结构的时空动态建模提供了新的视角。与传统的 CA 模型相比，混合元胞 CA 模型在元胞自动机的四个基本要素方面都有所不同，包括元胞状态、元胞空间、元胞邻域和转化规则。本文所提的 MCCA 模型利用随机森林回归算法，基于两期土地利用之间的变化自动构建元胞自动机的转化规则；并提出了模拟亚元胞尺度上多种土地利用类型之间相互竞争的机制，该机制可以用于定量地模拟像元内部土地利用结构的变化。此外，本文还提出了混合元胞 CA 模型的验证指标 mcFoM。我们将 MCCA 模型应用于武汉“1+8”城市圈的土地利用结构变化模拟当中，实验结果表明，MCCA 能够模拟土地单位内土地利用比例的精细及时空连续的变化。MCCA 模型的提出是地理元胞自动机应用的新的尝试和理论的重要补充，推进了混合土地利用研究从静态制图到动态模拟的发展。MCCA 的软件已在 https://github.com/HPSCIL/Mixed_Cell_Cellullar_Automata。

Keywords: Mixed cell，Cellular automata，Land use structure，Mixed land use，Land use change

## 1. 引言
需要对土地利用和土地覆盖（LULC）进行预测，以分析 LULC 变化对各种社会经济和生态过程的影响，包括人口增长、经济发展、碳循环、景观动态、地表水文和气候变化（Li et al.，2017，Pontius et al.，2011，Sohl et al.，2010）。因此，土地利用模型可以帮助了解土地利用系统的动态，并在规划实践中预测未来的土地利用变化，以实现更可持续的发展，并帮助保留生态安全（Huang，2014，Sohl et al.，2014，Verburg et al.，2002）。元胞自动机（CA）由于其简单且具有天然的时空动态性（Chaudhuri and Clarke，2013，White et al.，1997，He et al.，2020），已被广泛用于模拟多尺度的土地利用变化（Basse et al.，2014，Dong et al.，2018，Liang et al.，2020）。

传统上，地理空间 CA 模型假设系统内的每个元胞都是统一的土地利用类型，并在每个时间戳分配一个离散的状态标签（Chen et al.，2013，Pontius et al.，2007，Yeh and Li，2002，Zhai et al.，2020）。换句话说，传统 CA 模型的元胞状态是纯粹的、离散的（Clarke and Gaydos，1998，Pijanowski et al.，2006）。然而，由于土地利用模式的复杂性，特别是在城市中，一块土地通常是多种土地利用类型的混合物，服务于多种功能（Abdullahi，Pradhan，Mansor，& Shariff，2015）。因此，在 CA 模型的常用尺度下（如 30m × 30m 或更大），一个元胞的土地空间往往包含不同覆盖比例的各种土地利用类型，这意味着 CA 模型的网格（也称为元胞空间）不仅由纯元胞组成，而且还包括大量具有多种土地利用结构的混合元胞（Foody，1996）。例如，一个城市商业元胞可能包含政府办公室和住宅，一个农业元胞可能包含道路、房屋和池塘。值得注意的是，虽然“混合元胞”一词最早由（Hu and Li (2004)）提及，但他们的“混合元胞”指的是点、多线和多边形的混合，不同于本研究中“混合元胞”的概念，它代表了一个元胞内多种土地利用类型的混合。

土地元胞内部的混合结构是规划策略重点关注的问题之一（Song & Knaap，2004），因为它们与人的流动和能源消耗密切相关（Abdullahi et al.，2015），所以会影响环境的可持续性和土地元胞的功能（Liu et al.，2018，Yue et al.，2017）。以往的研究主要集中在混合土地利用的识别、测量和变化分析上（Shi & Yang，2015），只有少数研究关注混合土地利用的动态模拟（Charif et al.，2017，Omrani et al.，2015）。理解动态变化可以为理解混合土地利用与驱动因素之间的相互作用提供丰富的信息，为未来的可持续发展制定科学合理的土地利用计划。因此，需要一种新的建模方法来模拟土地利用结构的时空动态变化，以涵盖混合土地元胞内土地利用类别的比例。鉴于 CA 在土地利用建模方面的成功，具有混合元胞的 CA 模型似乎是实现这一目的的一种有希望的方法。

### 1.1 混合元胞 CA 与纯质元胞 CA 的对比
基于混合元胞的土地利用结构变化模拟是一个挑战，因为混合元胞 CA 与传统的纯质元胞 CA 有着本质的区别。CA 模型由五个基本元素组成：元胞、网格（或元胞空间）、邻域、一组初始状态和过渡规则。所有这些基本元素都必须为混合元胞的 CA 重新设计。此外，评估方法也必须重新设计，因为常用的方法主要是为纯质元胞 CA 设计的。

地理空间 CA 中的每个元胞都代表一个土地单元，每个元胞都有一个状态，代表土地单元的属性/状态。在纯质元胞 CA 模型中，从有限集中抽取一个离散的状态标签分配给一个元胞，代表土地单元的统一土地利用类型（Li & Yeh，2000）。与纯质元胞不同，混合元胞的状态是由一系列连续测量的分量组成的，每个分量代表某种土地利用类型的覆盖比例（图 1）。通过改变每个元胞的状态（即改变元胞内土地利用类型的覆盖比例），混合元胞 CA 模型能够模拟每个土地单元内土地利用混合物的连续结构变化，而纯质元胞 CA 模型只能模拟整个元胞的离散变化（Li et al.，2011，Liu and Phinn，2003，Seto et al.，2012）。

[![图片可能因为网络原因掉线了，请刷新或直接点我查看图片~](https://cdn.jsdelivr.net/gh/ylsislove/image-home/test/20210116195856.png)](https://cdn.jsdelivr.net/gh/ylsislove/image-home/test/20210116195856.png)

图 1. 混合元胞 CA 与纯质元胞 CA 的对比：元胞、邻域和网格的表示。

通常情况下，地理空间 CA 的网格是由一组排列在二维空间中的元胞组成，代表整个相关区域。随着时间的推移，网格内的元胞分别改变其状态，从而共同模拟区域内某一现象（如土地利用和/或土地覆盖）的时空动态。由于每个元胞有一个离散的状态标签，纯质元胞 CA 模型除了有其他层的驱动因素外，只有一层目标现象的网格（Wu & Webster，1998）。由于混合元胞的状态是由一系列的土地利用成分（即土地利用类型的覆盖比例）组成的，因此混合元胞 CA 的网格是一个多层结构，每一层都代表了某一土地利用类型的覆盖比例在区域内的分布。

邻域效应对 CA 模型至关重要（Li & Yeh，2002）。在纯质元胞的情况下，CA 模型往往用某一元胞周围邻域内各种土地利用类型的元胞数量（即移动窗口）来表示邻域状态（Chen et al.，2013，Shu et al.，2017，Wu，2002）。因此，邻域内土地利用状态的变化受其大小限制。例如，当使用 3 × 3 窗口时，邻域内的土地利用类型不超过 8 种（3 × 3 - 1）（Chen，Li，Liu，Ai，& Li，2016）。以连续测得的多种土地利用类型的覆盖比例作为混合元胞的状态，可以更详细地表示元胞的土地利用结构（图 1）。

混合元胞 CA 模型的过渡规则与纯质元胞 CA 模型的过渡规则主要有两个方面的不同。首先，纯质元胞 CA 模型在元胞尺度上通过不同土地利用类型之间的竞争来模拟土地利用的变化（Yang, Su, Chen, Xie, & Ge, 2016）。然而，混合元胞 CA 模型必须通过每个元胞内土地利用成分之间的竞争来估计土地利用类型的比例变化。混合元胞 CA 模型的过渡规则不仅要像纯质元胞 CA 模型（Verburg & Overmars，2009）那样考虑元胞尺度（如元胞位置的驱动因素影响）、邻域尺度（如邻域状态）和区域尺度（如土地需求）的影响，还要考虑多个土地利用组件之间的子元胞尺度竞争。其次，与纯质元胞 CA 模型模拟各元胞土地利用的质变相比，混合元胞 CA 模型模拟的是各元胞内部土地利用成分之间的量变。这一特点决定了混合元胞 CA 模型的过渡规则的构建应建立在对土地利用历史过渡的定量分析基础上。因此，在模拟多种土地利用类型的土地利用变化时，混合元胞 CA 模型的前景对于 CA 模型从定性模拟转向子元胞尺度的定量模拟具有重要意义。

最后，混合元胞 CA 模型的模拟结果是多种土地利用类型的覆盖比例分布（即图 1 中的多层网格）。传统的评估方法，如“混淆矩阵”（Congalton, 1991）和“优点图”（Pontius & Cheuk, 2006）都是针对纯质元胞 CA 的离散模拟结果设计的，无法评估混合元胞 CA 模型的连续和多维模拟结果。因此，评估混合元胞 CA 模型的精度是一个需要处理的问题。混合元胞的元胞状态是一个多维数组，代表相应土地单元的土地利用结构。因此，模拟结果与地面实况之间的土地利用结构相似性是混合元胞 CA 模型性能评估的重要内容。一个完善的混合元胞模拟框架需要合理可靠的评估方法，可以评估连续和多维分布的精度，评估模拟结果与地面真实之间的混合土地利用结构相似性，甚至评估混合元胞模拟的变化精度。

